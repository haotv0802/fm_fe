<div>
    <div class="filter-container">
    <table class="table table-bordered">
        <tr>
            <td class="filter-label-name">{{'admin.authorityRequest.userId'|translate}}</td>
            <td>
                <input id="userId" type="text" class="form-control" [(ngModel)]="authorityRequestFilter.userId"/>
            </td>
            <td class="filter-label-name">{{'admin.authorityRequest.userName'|translate}}</td>
            <td>
                <input id="userName" type="text" class="form-control" [(ngModel)]="authorityRequestFilter.userName"/>
            </td>
        </tr>

        <tr>
            <td class="filter-label-name">{{'admin.authorityRequest.authority'|translate}}</td>
            <td>
                <select [(ngModel)]="authorityRequestFilter.authority" class="form-control filter-cmp">
                    <option value="">본부명(전체)</option>
                    <option *ngFor="let auth of authorities" value="{{auth.id}}">{{auth.name}}</option>
                </select>
            </td>

            <td>
                <input id="department" type="text" class="form-control" [(ngModel)]="authorityRequestFilter.department"/>
            </td>
        </tr>

        <tr>
            <td class="filter-label-name">{{'admin.authorityRequest.status'|translate}}</td>
            <td>
                <select [(ngModel)]="authorityRequestFilter.status" class="form-control filter-cmp">
                    <option value="">(전체)</option>
                    <option *ngFor="let status of statuses" value="{{status.id}}">{{status.name}}</option>
                </select>
            </td>
        </tr>
    </table>

    </div>
    <div class="filter-action">
        <button style="min-width: 80px;" type="button" class="btn btn-primary" (click)="onSearch()">
            {{'label.search'|translate}}
        </button>
        <button style="width: 80px;" type="button" id='btn_save' (click)="onSave()"
                class="btn btn-success">{{'label.save'|translate}}
        </button>
        <button style="min-width: 80px;" type="button" (click)="onBtnClickExport()"
                class="btn btn-primary">{{'label.excel_export'|translate}}
        </button>
        <button style="min-width: 80px;" type="button" (click)="onBtnClickEmailExport()"
                class="btn btn-primary">{{'label.email_export'|translate}}
        </button>
    </div>

    <table class="table table-bordered">
        <thead>
        <tr>
            <th style="width: 50px; text-align: center; background-color: #D4D4D4">
                <input type="checkbox"
                       id="chk_all"
                       class="form-check-input"
                       (change)="handleCheckAll($event)"
                       [(ngModel)]="checkAll"
                >
            </th>
            <th style="text-align: center; background-color: #D4D4D4">{{'label.system'|translate}}</th>
            <th style="text-align: center; background-color: #D4D4D4">{{'label.userId'|translate}}</th>
            <th style="text-align: center; background-color: #D4D4D4">{{'label.userName'|translate}}</th>
            <th style="text-align: center; background-color: #D4D4D4">{{'label.orgVer'|translate}}</th>
            <th style="text-align: center; background-color: #D4D4D4">{{'label.dept'|translate}}</th>
            <th style="text-align: center; background-color: #D4D4D4">
                {{'label.authorityRequest'|translate}}
            </th>
            <th style="text-align: center; background-color: #D4D4D4">{{'label.pageList'|translate}}</th>
            <th style="text-align: center; background-color: #D4D4D4">{{'label.pageAuthority'|translate}}
            </th>
            <th style="text-align: center; background-color: #D4D4D4">{{'label.disableUser'|translate}}</th>
            <th style="text-align: center; background-color: #D4D4D4">{{'permissionChange.adminNotes'|translate}}</th>
            <th style="text-align: center; background-color: #D4D4D4">{{'label.updater'|translate}}</th>
            <th style="text-align: center; background-color: #D4D4D4">{{'label.updatedTime'|translate}}</th>
            <th style="text-align: center; background-color: #D4D4D4">{{'permissionChange.delete'|translate}}</th>
        </tr>
        </thead>
        <tbody>
        <tr *ngFor="let item of authorityRequests; let idx = index">
            <td style="text-align: center">
                <input type="checkbox" id="chk_{{item.srl}}"

                       (change)="handleCheck($event, item)"
                       class="form-check-input" [checked]="item.isChecked">
            </td>
            <td>
                <select [(ngModel)]="item.appliedToSystem" class="form-control" (change)="handleSystemChange(item)">
                    <option value="1">{{'register.snoopy1'|translate}}</option>
                    <option value="2">{{'register.snoopy2'|translate}}</option>
                    <option value="0">{{'register.snoopy12'|translate}}</option>
                </select>
            </td>
            <td>{{item.userId}}</td>
            <td>{{item.userName}}</td>
            <td>{{item.categoryVersion}}</td>
            <td>{{item.department}}</td>
            <td>
                <span *ngFor="let subItem of item.authorityRequests">
                    <input type="checkbox" id=`chkOrg_{{item.srl}}_{{subItem.no}}`
                           (change)="handleCategoryCheck($event, subItem)" [checked]="subItem.checked"
                           class="form-check-input">
                    <label for=`chkOrg_{{item.srl}}_{{subItem.no}}`>{{subItem.name}}</label>
                </span>
            </td>
            <td>
                <span *ngFor="let subItem of item.pageAuthRequests">
                    <input type="checkbox" id=`chkPageId_{{item.srl}}_{{subItem.no}}`
                           (change)="handlePageAuthCheck($event, subItem)" [checked]="subItem.checked"
                           class="form-check-input">
                    <label for=`chkPageId_{{item.srl}}_{{subItem.no}}`>{{subItem.name}}</label>
                </span>
            </td>
            <td>
                <select class="form-control" id=`pageAuthority_{{item.srl}}`
                        (change)="handlePageAuthorityChange($event, item)"
                >
                    <option value="admin" [selected] = "item.pageAuthority === 'admin'">{{'label.admin'|translate}}</option>
                    <option value="user" [selected] = "item.pageAuthority === 'user'">{{'label.user'|translate}}</option>
                </select>
            </td>
            <td>
                <select class="form-control" id="delete_{{item.srl}}" (change)="handleDisableUser($event, item)">
                    <option value="Y" [selected]="item.status === 'Y'">{{'label.isActive'|translate}}</option>
                    <option value="N" [selected]="item.status === 'N'">{{'label.isInActive'|translate}}</option>
                    <option value="N" [selected]="item.status === 'O'">{{'label.isResigned'|translate}}</option>
                </select>
            </td>
            <td><input type="text" [(ngModel)] = "item.adminMemo" style="width: 100%;"></td>
            <td>{{item.updater}}</td>
            <td>{{item.updatedTime}}</td>
            <td style="text-align: center"><input type="checkbox" [(ngModel)]="item.deleted" (change)="onClickDeleteCheckbox($event, item)"></td>
        </tr>
        </tbody>
    </table>
    <div style="text-align: center">
    <pagination [(ngModel)]="pagination.pageRequest.page" (pageChanged)="onPaginationChanged($event)"
                [boundaryLinks]="false" [totalItems]="pagination.totalItems"
                [maxSize]="10" [itemsPerPage]="pagination.itemPerPage" class="pagination-sm"
                previousText="PREV" nextText="NEXT" firstText="FIRST" lastText="LAST"></pagination>
    </div>
</div>
